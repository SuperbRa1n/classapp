{"version":3,"file":"date.js","sources":["pages/date/date.vue","pages/date/date.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- Term Switcher -->\n    <scroll-view scroll-x class=\"term-summary\">\n      <view v-for=\"(term, index) in termSwitcher\" :key=\"index\" class=\"term-item\"\n        :class=\"{ 'selected-term-item': term === selectedTerm }\" @tap=\"selectTerm(term)\">\n        <text class=\"term-label\">{{ term }}</text>\n      </view>\n    </scroll-view>\n\n    <!-- Timetable -->\n    <scroll-view scroll-y class=\"timetable\">\n      <view class=\"header-row\">\n        <view class=\"time-cell\"></view>\n        <view v-for=\"day in days\" :key=\"day\" class=\"day-cell\">\n          <text class=\"day-header\">{{ day }}</text>\n        </view>\n      </view>\n      <view v-for=\"(time, timeIndex) in timeSlots\" :key=\"timeIndex\" class=\"row\">\n        <view class=\"time-cell\">\n          <text class=\"time-index\">{{ timeIndex + 1 }}</text>\n          <text class=\"time-label\">{{ time }}</text>\n        </view>\n        <view v-for=\"(day, dayIndex) in days\" :key=\"dayIndex\" class=\"class-cell\">\n          <view v-if=\"getClassForTime(dayIndex, timeIndex)\" class=\"class-block\"\n            :style=\"{ height: getClassHeight(dayIndex, timeIndex) + 'vh' }\"\n            @tap=\"navigateToDetail(getClassForTime(dayIndex, timeIndex).kcmc)\">\n            <text class=\"class-name\">\n              {{ getClassForTime(dayIndex, timeIndex).kcmc }}\n            </text>\n            <text class=\"class-location\">\n              @{{ getClassForTime(dayIndex, timeIndex).cdmc }}\n            </text>\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      classInfo: [],\n      termSwitcher: [],\n      selectedTerm: '',\n      isTermSet: false,\n      timeSlots: [\n        '08:00',\n        '08:50',\n        '10:00',\n        '10:50',\n        '11:40',\n        '13:25',\n        '14:15',\n        '15:05',\n        '16:15',\n        '17:05',\n        '18:50',\n        '19:40',\n        '20:30',\n        '21:20',\n      ],\n      days: ['一', '二', '三', '四', '五', '六', '日'],\n    };\n  },\n  onLoad() {\n    this.initializeData();\n  },\n  methods: {\n    async initializeData() {\n      try {\n        const classInfo = uni.getStorageSync('classInfo');\n        this.classInfo = classInfo ? classInfo : [];\n        this.generateTermSwitcher();\n        if (!this.isTermSet) {\n          this.selectedTerm = this.termSwitcher[0];\n          this.isTermSet = true;\n        }\n      } catch (error) {\n        console.error('Error initializing data:', error);\n      }\n    },\n    generateTermSwitcher() {\n      const termSet = new Set();\n      this.classInfo.forEach((item) => {\n        if (item.kbList.length > 0) {\n          const xnm = item.xsxx.XNMC;\n          const xqm = item.xsxx.XQM === '3' ? '秋冬' : '春夏';\n          termSet.add(`${xnm}${xqm}`);\n        }\n      });\n      this.termSwitcher = Array.from(termSet).sort((a, b) => {\n        const yearA = a.slice(0, 9);\n        const yearB = b.slice(0, 9);\n        return yearA === yearB ? (a.includes('秋冬') ? 1 : -1) : yearB - yearA;\n      });\n    },\n    selectTerm(term) {\n      this.selectedTerm = term;\n    },\n    getClassForTime(dayIndex, timeIndex) {\n      const selectedClasses = this.classInfo.filter(\n        (c) =>\n          `${c.xsxx.XNMC}${c.xsxx.XQM === '3' ? '秋冬' : '春夏'}` ===\n          this.selectedTerm\n      )[0]?.kbList || [];\n      return selectedClasses.find(\n        (c) =>\n          parseInt(c.xqj) === dayIndex + 1 &&\n          parseInt(c.jcs.split('-')[0]) === timeIndex + 1\n      );\n    },\n    getClassHeight(dayIndex, timeIndex) {\n      const classForThisTime = this.getClassForTime(dayIndex, timeIndex);\n      if (classForThisTime) {\n        const [start, end] = classForThisTime.jcs.split('-').map(Number);\n        return (end - start + 1) * 6; // 每节课占用 6vh 高度\n      }\n      return 6;\n    },\n    navigateToDetail(courseName) {\n      uni.navigateTo({\n        url: `/pages/courseDetail/courseDetail?name=${courseName}`,\n      });\n    },\n  },\n};\n</script>\n\n<style>\n.container {\n  padding: 2vw;\n  background-color: #f8f8f8;\n}\n\n.term-summary {\n  display: flex;\n  flex-direction: row;\n  overflow-x: auto;\n  padding: 2vw 0;\n  background-color: #fff;\n  border-radius: 2vw;\n  margin-bottom: 4vw;\n}\n\n.term-item {\n  padding: 1vw 3vw;\n  margin-right: 2vw;\n  background-color: #f0f0f0;\n  border-radius: 2vw;\n  text-align: center;\n}\n\n.selected-term-item {\n  background-color: #e3f2fd;\n}\n\n.term-label {\n  font-size: 3vw;\n  color: #666;\n}\n\n.timetable {\n  background-color: #fff;\n  border-radius: 2vw;\n  padding: 2vw;\n  overflow: hidden;\n}\n\n.header-row {\n  display: flex;\n  flex-direction: row;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n}\n\n.time-cell {\n  width: 12vw;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n}\n\n.day-cell {\n  width: 12vw;\n  justify-content: center;\n  align-items: center;\n}\n\n.day-header {\n  font-size: 4vw;\n  font-weight: bold;\n}\n\n.class-cell {\n  width: 12vw;\n  height: 6vh;\n  justify-content: center;\n  align-items: center;\n}\n\n.class-block {\n  background-color: #74c6f7;\n  border-radius: 1vw;\n  padding: 1vw;\n  align-items: center;\n  justify-content: center;\n  position: absolute;\n  width: 12vw;\n}\n\n.class-name {\n  font-size: 2.5vw;\n  color: #fff;\n}\n\n.class-location {\n  font-size: 2vw;\n  color: #fff;\n}\n\n.time-index {\n  font-size: 3vw;\n  font-weight: bold;\n  text-align: center;\n}\n\n.time-label {\n  font-size: 2.5vw;\n  color: #666;\n  text-align: center;\n}\n</style>","import MiniProgramPage from '/Users/tanninrachel/Documents/code/classapp/pages/date/date.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAyCA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,WAAW,CAAE;AAAA,MACb,cAAc,CAAE;AAAA,MAChB,cAAc;AAAA,MACd,WAAW;AAAA,MACX,WAAW;AAAA,QACT;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD,MAAM,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAAG;AAAA;EAE3C;AAAA,EACD,SAAS;AACP,SAAK,eAAc;AAAA,EACpB;AAAA,EACD,SAAS;AAAA,IACP,MAAM,iBAAiB;AACrB,UAAI;AACF,cAAM,YAAYA,cAAAA,MAAI,eAAe,WAAW;AAChD,aAAK,YAAY,YAAY,YAAY,CAAA;AACzC,aAAK,qBAAoB;AACzB,YAAI,CAAC,KAAK,WAAW;AACnB,eAAK,eAAe,KAAK,aAAa,CAAC;AACvC,eAAK,YAAY;AAAA,QACnB;AAAA,MACA,SAAO,OAAO;AACdA,sBAAc,MAAA,MAAA,SAAA,6BAAA,4BAA4B,KAAK;AAAA,MACjD;AAAA,IACD;AAAA,IACD,uBAAuB;AACrB,YAAM,UAAU,oBAAI;AACpB,WAAK,UAAU,QAAQ,CAAC,SAAS;AAC/B,YAAI,KAAK,OAAO,SAAS,GAAG;AAC1B,gBAAM,MAAM,KAAK,KAAK;AACtB,gBAAM,MAAM,KAAK,KAAK,QAAQ,MAAM,OAAO;AAC3C,kBAAQ,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,QAC5B;AAAA,MACF,CAAC;AACD,WAAK,eAAe,MAAM,KAAK,OAAO,EAAE,KAAK,CAAC,GAAG,MAAM;AACrD,cAAM,QAAQ,EAAE,MAAM,GAAG,CAAC;AAC1B,cAAM,QAAQ,EAAE,MAAM,GAAG,CAAC;AAC1B,eAAO,UAAU,QAAS,EAAE,SAAS,IAAI,IAAI,IAAI,KAAM,QAAQ;AAAA,MACjE,CAAC;AAAA,IACF;AAAA,IACD,WAAW,MAAM;AACf,WAAK,eAAe;AAAA,IACrB;AAAA,IACD,gBAAgB,UAAU,WAAW;;AACnC,YAAM,oBAAkB,UAAK,UAAU;AAAA,QACrC,CAAC,MACC,GAAG,EAAE,KAAK,IAAI,GAAG,EAAE,KAAK,QAAQ,MAAM,OAAO,IAAI,OACjD,KAAK;AAAA,MACT,EAAE,CAAC,MAJqB,mBAIlB,WAAU;AAChB,aAAO,gBAAgB;AAAA,QACrB,CAAC,MACC,SAAS,EAAE,GAAG,MAAM,WAAW,KAC/B,SAAS,EAAE,IAAI,MAAM,GAAG,EAAE,CAAC,CAAC,MAAM,YAAY;AAAA;IAEnD;AAAA,IACD,eAAe,UAAU,WAAW;AAClC,YAAM,mBAAmB,KAAK,gBAAgB,UAAU,SAAS;AACjE,UAAI,kBAAkB;AACpB,cAAM,CAAC,OAAO,GAAG,IAAI,iBAAiB,IAAI,MAAM,GAAG,EAAE,IAAI,MAAM;AAC/D,gBAAQ,MAAM,QAAQ,KAAK;AAAA,MAC7B;AACA,aAAO;AAAA,IACR;AAAA,IACD,iBAAiB,YAAY;AAC3BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,yCAAyC,UAAU;AAAA,MAC1D,CAAC;AAAA,IACF;AAAA,EACF;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/HA,GAAG,WAAW,eAAe;"}