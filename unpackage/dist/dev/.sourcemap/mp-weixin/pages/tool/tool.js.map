{"version":3,"file":"tool.js","sources":["pages/tool/tool.vue","pages/tool/tool.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- Header Section -->\n    <view class=\"grade-summary\">\n      <view\n        v-for=\"(item, index) in gradeSummary\"\n        :key=\"index\"\n        class=\"grade-item\"\n        :style=\"{ backgroundColor: item.color }\"\n      >\n        <text class=\"grade-label\">{{ item.label }}</text>\n        <text class=\"grade-value\">{{ item.value }}</text>\n      </view>\n    </view>\n\n    <!-- Term Switcher -->\n    <scroll-view scroll-x=\"true\" class=\"term-summary\">\n      <view\n        v-for=\"(term, index) in termSwitcher\"\n        :key=\"index\"\n        class=\"term-item\"\n        :class=\"{ 'selected-term-item': term === selectedTerm }\"\n        @tap=\"selectTerm(term)\"\n      >\n        <text class=\"term-label\">{{ term }}</text>\n      </view>\n    </scroll-view>\n\n    <!-- Course List -->\n    <scroll-view scroll-y class=\"course-list\">\n      <view\n        v-for=\"(course, index) in getCoursesByTerm(selectedTerm)\"\n        :key=\"index\"\n        class=\"course-item\"\n        @tap=\"navigateToDetail(course.kcmc)\"\n      >\n        <view class=\"course-header\">\n          <view style=\"width: 60%; text-align: left;\"><text class=\"course-name\">{{ course.kcmc }}</text></view>\n          <view style=\"width: 40%; text-align: right;\"><text class=\"course-score\">{{ course.bfzcj }} / {{ course.jd }}</text></view>\n        </view>\n        <text class=\"course-info\">\n          {{ course.jxbmc }} / {{ course.xf }} 学分\n        </text>\n        <view class=\"progress-bar-container\">\n          <view\n            class=\"progress-bar\"\n            :style=\"{ width: course.bfzcj + '%' }\"\n          ></view>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      classInfo: [],\n      gradeInfo: [],\n      selectedTerm: '',\n      termSwitcher: [],\n      totalCredit: 0,\n      totalGrade: 0,\n      yearCredit: 0,\n      yearGrade: 0,\n      xueqiCredit: 0,\n      xueqiGrade: 0,\n      totalBaiFenZhi: 0,\n      xueqiBaiFenZhi: 0,\n      isTermSet: false,\n    };\n  },\n  computed: {\n    gradeSummary() {\n      return [\n        { label: '总均绩', value: this.totalGrade.toFixed(2), color: '#E3F2FD' },\n        { label: '获得学分', value: this.totalCredit.toFixed(2), color: '#FFF3E0' },\n        { label: '学年均绩', value: this.yearGrade.toFixed(2), color: '#E8F5E9' },\n        { label: '学年学分', value: this.yearCredit.toFixed(2), color: '#F3E5F5' },\n        { label: '学期均绩', value: this.xueqiGrade.toFixed(2), color: '#FFFDE7' },\n        { label: '学期学分', value: this.xueqiCredit.toFixed(2), color: '#E1F5FE' },\n        { label: '总百分制', value: this.totalBaiFenZhi.toFixed(2), color: '#FFEBEE' },\n        { label: '学期百分制', value: this.xueqiBaiFenZhi.toFixed(2), color: '#E0F7FA' },\n      ];\n    },\n  },\n  onLoad() {\n    this.initializeData();\n  },\n  methods: {\n    async initializeData() {\n      try {\n        const classInfo = uni.getStorageSync('classInfo');\n        const gradeInfo = uni.getStorageSync('gradeInfo');\n        this.classInfo = classInfo ? classInfo : [];\n        this.gradeInfo = gradeInfo ? gradeInfo : [];\n        console.log('classInfo', this.classInfo);\n        console.log('gradeInfo', this.gradeInfo);\n        this.generateTermSwitcher();\n        if (!this.isTermSet) {\n          this.selectedTerm = this.termSwitcher[0];\n          this.isTermSet = true;\n          this.updateGrades();\n        }\n      } catch (error) {\n        console.error('Error initializing data:', error);\n      }\n    },\n    generateTermSwitcher() {\n      const termSet = new Set();\n      this.classInfo.forEach((item) => {\n        if (item.kbList.length > 0) {\n          const xnm = item.xsxx.XNMC;\n          const xqm = item.xsxx.XQM === '3' ? '秋冬' : '春夏';\n          const term = `${xnm}${xqm}`;\n          termSet.add(term);\n        }\n      });\n      this.termSwitcher = Array.from(termSet).sort((a, b) => {\n        if (a.substring(0, 9) < b.substring(0, 9)) return 1;\n        if (a.substring(0, 9) > b.substring(0, 9)) return -1;\n        return a.substring(9, 11) === '秋冬' ? 1 : -1;\n      });\n    },\n    selectTerm(term) {\n      this.selectedTerm = term;\n      this.updateGrades();\n    },\n    updateGrades() {\n      const totalItems = [];\n      const yearItems = [];\n      const xueqiItems = [];\n      this.gradeInfo.forEach((item) => {\n        const items = item.items || [];\n        items.forEach((course) => {\n          totalItems.push(course);\n          if (course.xnmmc === this.selectedTerm.substring(0, 9)) {\n            yearItems.push(course);\n            if (\n              (course.xqmmc === '1' &&\n                this.selectedTerm.substring(9, 11) === '秋冬') ||\n              (course.xqmmc === '2' &&\n                this.selectedTerm.substring(9, 11) === '春夏')\n            ) {\n              xueqiItems.push(course);\n            }\n          }\n        });\n      });\n      this.totalCredit = this.calculateCredit(totalItems);\n      this.totalGrade = this.calculateGPA(totalItems);\n      this.yearCredit = this.calculateCredit(yearItems);\n      this.yearGrade = this.calculateGPA(yearItems);\n      this.xueqiCredit = this.calculateCredit(xueqiItems);\n      this.xueqiGrade = this.calculateGPA(xueqiItems);\n      this.totalBaiFenZhi = this.calculateBaiFenZhi(totalItems);\n      this.xueqiBaiFenZhi = this.calculateBaiFenZhi(xueqiItems);\n    },\n    calculateGPA(grades) {\n      let totalCredit = 0;\n      let totalGrade = 0;\n      grades.forEach((item) => {\n        totalCredit += parseFloat(item.xf);\n        totalGrade += parseFloat(item.xf) * parseFloat(item.jd);\n      });\n      return totalGrade / totalCredit;\n    },\n    calculateCredit(grades) {\n      let totalCredit = 0;\n      grades.forEach((item) => {\n        totalCredit += parseFloat(item.xf);\n      });\n      return totalCredit;\n    },\n    calculateBaiFenZhi(grades) {\n      let totalCredit = 0;\n      let totalGrade = 0;\n      grades.forEach((item) => {\n        totalCredit += parseFloat(item.xf);\n        totalGrade += parseFloat(item.xf) * parseFloat(item.bfzcj);\n      });\n      return totalGrade / totalCredit;\n    },\n    calculateXueqiGPA(term) {\n      return this.calculateGPA(this.getCoursesByTerm(term));\n    },\n    calculateXueqiCredit(term) {\n      return this.calculateCredit(this.getCoursesByTerm(term));\n    },\n    getCoursesByTerm(term) {\n      const xnmmc = term.substring(0, 9);\n      const xqmmc = term.substring(9, 11);\n      const xqmTable = { 秋冬: '1', 春夏: '2' };\n      return this.gradeInfo\n        .flatMap((item) => item.items || [])\n        .filter(\n          (course) =>\n            course.xnmmc === xnmmc && course.xqmmc === xqmTable[xqmmc]\n        )\n        .sort((a, b) => parseFloat(b.bfzcj) - parseFloat(a.bfzcj));\n    },\n    navigateToDetail(courseName) {\n      uni.navigateTo({\n        url: `/pages/courseDetail/courseDetail?name=${courseName}`,\n      });\n    },\n  },\n};\n</script>\n\n<style>\n.container {\n  padding: 16px;\n  background-color: #f8f8f8;\n}\n.grade-summary {\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  gap: 10px;\n  margin-bottom: 16px;\n}\n.grade-item {\n  padding: 10px;\n  border-radius: 8px;\n  text-align: center;\n}\n.term-summary {\n  white-space: nowrap;\n  margin-bottom: 16px;\n  width: 100%;\n}\n.term-item {\n  display: inline-block;\n  padding: 10px 15px;\n  background-color: #f0f0f0;\n  border-radius: 8px;\n  margin-right: 8px;\n  text-align: center;\n  width: 30vw;\n}\n.selected-term-item {\n  background-color: #E3F2FD;\n}\n.course-list {\n  margin-top: 10px;\n}\n.course-item {\n  padding: 10px;\n  background-color: #fff;\n  border-radius: 8px;\n  margin-bottom: 10px;\n}\n.course-header {\n  display: flex;\n  justify-content: space-between;\n}\n.progress-bar-container {\n  margin-top: 5px;\n  height: 10px;\n  background-color: #e0e0e0;\n  border-radius: 5px;\n  overflow: hidden;\n}\n.progress-bar {\n  height: 100%;\n  background-color: #74c6f7;\n}\n.course-name {\n  font-size: 16px;\n  font-weight: bold;\n}\n.course-score {\n  font-size: 20px;\n  font-weight: bold;\n}\n.course-info {\n  font-size: 14px;\n  color: #666;\n}\n.grade-label {\n  font-size: 14px;\n  font-weight: bold;\n}\n.grade-value {\n  font-size: 16px;\n  font-weight: bold;\n}\n.term-label {\n  font-size: 14px;\n}\n</style>\n","import MiniProgramPage from '/Users/tanninrachel/Documents/code/classapp/pages/tool/tool.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}