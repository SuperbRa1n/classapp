{"version":3,"file":"api.js","sources":["utils/api.js"],"sourcesContent":["export const BASE_URL = 'https://myjw.zeabur.app';\n\nexport const LOGIN = '/login';\n\nexport const CLASSINFO = '/class';\n\nexport const GRADEINFO = '/grade';\n\nexport const CODE = '/get_code';\n\nexport const DEFAULT_AVATAR = 'https://one.fjsmu.edu.cn/tp_up/resource/image/common/userpic.png';\n\nexport const xnmList = ['2030', '2029', '2028', '2027', '2026', '2025', '2024', '2023', '2022', '2021', '2019', '2018'];\n\nexport const xqmList = ['3', '12'];\n\nconst request = (url, data) => {\n  return new Promise((resolve, reject) => {\n    uni.request({\n      url: BASE_URL + url,\n      method: 'POST',\n      data: data,\n      header: {\n        'Content-Type': 'application/json',\n      },\n      success: (res) => {\n        if (res.statusCode === 200) {\n          resolve(res.data);\n        } else {\n          reject(res.data || 'Request failed');\n        }\n      },\n      fail: (err) => {\n        reject(err || 'Request failed');\n      },\n    });\n  });\n};\n\nexport const getClassInfo = async (JSESSIONID) => {\n  const result = [];\n  for (const xnm of xnmList) {\n    for (const xqm of xqmList) {\n      const data = {\n        JSESSIONID: JSESSIONID,\n        xnm: xnm,\n        xqm: xqm,\n      };\n      try {\n        const response = await request(CLASSINFO, data);\n        result.push(response);\n      } catch (err) {\n        console.error(`Error fetching class info for xnm: ${xnm}, xqm: ${xqm}`, err);\n      }\n    }\n  }\n  return result;\n};\n\nexport const getGradeInfo = async (JSESSIONID) => {\n  const result = [];\n  for (const xnm of xnmList) {\n    for (const xqm of xqmList) {\n      const data = {\n        JSESSIONID: JSESSIONID,\n        xnm: xnm,\n        xqm: xqm,\n      };\n      try {\n        const response = await request(GRADEINFO, data);\n        result.push(response);\n      } catch (err) {\n        console.error(`Error fetching grade info for xnm: ${xnm}, xqm: ${xqm}`, err);\n      }\n    }\n  }\n  return result;\n};\n\nexport const getUserInfo = async (JSESSIONID) => {\n  const data = {\n    JSESSIONID: JSESSIONID,\n    xnm: xnmList[0],\n    xqm: xqmList[0],\n  };\n  try {\n    const response = await request(CLASSINFO, data);\n    return {\n      name: response.xsxx.XM,\n      id: response.xsxx.XH_ID,\n      class: response.xsxx.BJMC,\n    };\n  } catch (err) {\n    console.error('Error fetching user info', err);\n    throw err;\n  }\n};\n"],"names":["uni"],"mappings":";;AAAY,MAAC,WAAW;AAEZ,MAAC,QAAQ;AAEd,MAAM,YAAY;AAElB,MAAM,YAAY;AAMlB,MAAM,UAAU,CAAC,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,MAAM;AAE/G,MAAM,UAAU,CAAC,KAAK,IAAI;AAEjC,MAAM,UAAU,CAAC,KAAK,SAAS;AAC7B,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCA,kBAAAA,MAAI,QAAQ;AAAA,MACV,KAAK,WAAW;AAAA,MAChB,QAAQ;AAAA,MACR;AAAA,MACA,QAAQ;AAAA,QACN,gBAAgB;AAAA,MACjB;AAAA,MACD,SAAS,CAAC,QAAQ;AAChB,YAAI,IAAI,eAAe,KAAK;AAC1B,kBAAQ,IAAI,IAAI;AAAA,QAC1B,OAAe;AACL,iBAAO,IAAI,QAAQ,gBAAgB;AAAA,QACpC;AAAA,MACF;AAAA,MACD,MAAM,CAAC,QAAQ;AACb,eAAO,OAAO,gBAAgB;AAAA,MAC/B;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;AAEY,MAAC,eAAe,OAAO,eAAe;AAChD,QAAM,SAAS,CAAA;AACf,aAAW,OAAO,SAAS;AACzB,eAAW,OAAO,SAAS;AACzB,YAAM,OAAO;AAAA,QACX;AAAA,QACA;AAAA,QACA;AAAA,MACR;AACM,UAAI;AACF,cAAM,WAAW,MAAM,QAAQ,WAAW,IAAI;AAC9C,eAAO,KAAK,QAAQ;AAAA,MACrB,SAAQ,KAAK;AACZA,sBAAAA,MAAc,MAAA,SAAA,sBAAA,sCAAsC,GAAG,UAAU,GAAG,IAAI,GAAG;AAAA,MAC5E;AAAA,IACF;AAAA,EACF;AACD,SAAO;AACT;AAEY,MAAC,eAAe,OAAO,eAAe;AAChD,QAAM,SAAS,CAAA;AACf,aAAW,OAAO,SAAS;AACzB,eAAW,OAAO,SAAS;AACzB,YAAM,OAAO;AAAA,QACX;AAAA,QACA;AAAA,QACA;AAAA,MACR;AACM,UAAI;AACF,cAAM,WAAW,MAAM,QAAQ,WAAW,IAAI;AAC9C,eAAO,KAAK,QAAQ;AAAA,MACrB,SAAQ,KAAK;AACZA,sBAAAA,MAAc,MAAA,SAAA,sBAAA,sCAAsC,GAAG,UAAU,GAAG,IAAI,GAAG;AAAA,MAC5E;AAAA,IACF;AAAA,EACF;AACD,SAAO;AACT;AAEY,MAAC,cAAc,OAAO,eAAe;AAC/C,QAAM,OAAO;AAAA,IACX;AAAA,IACA,KAAK,QAAQ,CAAC;AAAA,IACd,KAAK,QAAQ,CAAC;AAAA,EAClB;AACE,MAAI;AACF,UAAM,WAAW,MAAM,QAAQ,WAAW,IAAI;AAC9C,WAAO;AAAA,MACL,MAAM,SAAS,KAAK;AAAA,MACpB,IAAI,SAAS,KAAK;AAAA,MAClB,OAAO,SAAS,KAAK;AAAA,IAC3B;AAAA,EACG,SAAQ,KAAK;AACZA,kBAAc,MAAA,MAAA,SAAA,sBAAA,4BAA4B,GAAG;AAC7C,UAAM;AAAA,EACP;AACH;;;;;;"}